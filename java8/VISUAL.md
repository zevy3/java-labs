# 🎨 ВИЗУАЛЬНОЕ ОБЪЯСНЕНИЕ ПРОЕКТА

## 📐 АРХИТЕКТУРА ПРОЕКТА

```
┌─────────────────────────────────────────────────────────────┐
│                         Main.java                           │
│                    (Точка входа)                            │
└───────────────────────┬─────────────────────────────────────┘
                        │
                        ▼
┌─────────────────────────────────────────────────────────────┐
│                     DataManager.java                        │
│  ┌──────────────────────────────────────────────────────┐  │
│  │ • List<String> data                                  │  │
│  │ • List<Object> processors                            │  │
│  │ • ExecutorService executorService                    │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                              │
│  Методы:                                                     │
│  • loadData()        ────→ Читает файл                      │
│  • processData()     ────→ Обрабатывает данные              │
│  • saveData()        ────→ Сохраняет файл                   │
│  • registerDataProcessor() ─→ Регистрирует обработчики      │
└──────────────┬───────────────────────────────────┬──────────┘
               │                                   │
               │ Регистрация                       │ Использует
               │                                   │
               ▼                                   ▼
┌──────────────────────────────┐    ┌─────────────────────────┐
│   @DataProcessor             │    │   ExecutorService        │
│   (Аннотация)                │    │   (Пул потоков)         │
│                              │    │                         │
│   • name: String             │    │   Thread 1 ◄──┐         │
│   • priority: int            │    │   Thread 2 ◄──┤         │
└──────────────┬───────────────┘    │   Thread 3 ◄──┼─ Задачи│
               │                    │   Thread 4 ◄──┘         │
               │ Помечает           └─────────────────────────┘
               │
               ▼
┌──────────────────────────────────────────────────────────────┐
│                      ОБРАБОТЧИКИ                              │
├──────────────────────────────────────────────────────────────┤
│  FilterProcessor         TransformProcessor                   │
│  ┌─────────────────┐    ┌──────────────────┐                │
│  │ @DataProcessor  │    │ @DataProcessor   │                │
│  │ filterLong()    │    │ toUpperCase()    │                │
│  │                 │    │                  │                │
│  │ @DataProcessor  │    │ @DataProcessor   │                │
│  │ filterNumbers() │    │ addPrefix()      │                │
│  └─────────────────┘    └──────────────────┘                │
│                                                               │
│  AggregationProcessor                                         │
│  ┌─────────────────┐                                         │
│  │ @DataProcessor  │                                         │
│  │ groupByLength() │                                         │
│  │                 │                                         │
│  │ @DataProcessor  │                                         │
│  │ getStats()      │                                         │
│  └─────────────────┘                                         │
└──────────────────────────────────────────────────────────────┘
```

---

## 🔄 ЖИЗНЕННЫЙ ЦИКЛ ДАННЫХ

```
START
  │
  ▼
┌─────────────────────┐
│  data/input.txt     │ ◄─── Исходный файл
│  • Line 1           │
│  • Line 2           │
│  • Line 3           │
│  • ...              │
└──────┬──────────────┘
       │
       │ loadData()
       ▼
┌─────────────────────┐
│ List<String> data   │ ◄─── В памяти
│ [Line 1, Line 2,...]│
└──────┬──────────────┘
       │
       │ processData()
       ▼
┌─────────────────────────────────────────┐
│         ExecutorService                 │
│  ┌──────────────────────────────────┐  │
│  │  Future 1 ──→ [Result 1]         │  │
│  │  Future 2 ──→ [Result 2]         │  │
│  │  Future 3 ──→ [Result 3]         │  │
│  │  Future 4 ──→ [Result 4]         │  │
│  └──────────────────────────────────┘  │
└──────────┬──────────────────────────────┘
           │
           │ future.get() - ждём всех
           ▼
┌─────────────────────┐
│ List<String> result │ ◄─── Обработанные данные
│ [Processed 1,       │
│  Processed 2, ...]  │
└──────┬──────────────┘
       │
       │ saveData()
       ▼
┌─────────────────────┐
│ data/output.txt     │ ◄─── Результат
│ • Processed Line 1  │
│ • Processed Line 2  │
│ • ...               │
└─────────────────────┘
  │
  ▼
END
```

---

## 🧵 КАК РАБОТАЕТ МНОГОПОТОЧНОСТЬ

### Без многопоточности (последовательно):
```
Время →

Thread Main: [Task 1] [Task 2] [Task 3] [Task 4]
             ├───────┤ ├───────┤ ├───────┤ ├───────┤
             0       1 1       2 2       3 3       4

Общее время: 4 секунды
```

### С многопоточностью (параллельно):
```
Время →

Thread 1:    [Task 1]
             ├───────┤
             0       1

Thread 2:    [Task 2]
             ├───────┤
             0       1

Thread 3:    [Task 3]
             ├───────┤
             0       1

Thread 4:    [Task 4]
             ├───────┤
             0       1

Общее время: 1 секунда (в 4 раза быстрее!)
```

---

## 🔍 КАК РАБОТАЕТ REFLECTION

```
1. У нас есть объект обработчика:
   ┌──────────────────────┐
   │  FilterProcessor     │
   │  ┌────────────────┐  │
   │  │ method1()      │  │ ◄─── Без аннотации
   │  └────────────────┘  │
   │  ┌────────────────┐  │
   │  │ @DataProcessor │  │ ◄─── С аннотацией!
   │  │ filterLong()   │  │
   │  └────────────────┘  │
   │  ┌────────────────┐  │
   │  │ @DataProcessor │  │ ◄─── С аннотацией!
   │  │ filterNumbers()│  │
   │  └────────────────┘  │
   └──────────────────────┘

2. Reflection "смотрит" на объект:
   processor.getClass().getDeclaredMethods()
   ↓
   [method1, filterLong, filterNumbers]

3. Проверяем каждый метод на наличие аннотации:
   method.isAnnotationPresent(DataProcessor.class)
   ↓
   method1: ❌ нет аннотации
   filterLong: ✅ есть аннотация!
   filterNumbers: ✅ есть аннотация!

4. Вызываем только помеченные методы:
   method.invoke(processor, data)
   ↓
   Выполняется filterLong()
   Выполняется filterNumbers()
```

---

## 🌊 КАК РАБОТАЕТ STREAM API

### Пример: фильтрация длинных строк

```
Исходные данные:
┌─────┐
│ Hi  │ ─────┐
├─────┤      │
│ Java│ ─────┤
├─────┤      │
│ Hello World │ ◄── Длинная (> 5)
├─────┤      │
│ Code│ ─────┤
├─────┤      │
│ Programming │ ◄── Длинная (> 5)
└─────┘      │
             │
             │ .stream()
             ▼
        ┌─────────┐
        │ ПОТОК   │
        └────┬────┘
             │
             │ .filter(s -> s.length() > 5)
             ▼
        ┌─────────┐
        │ ФИЛЬТР  │ ◄── Пропускает только длинные
        └────┬────┘
             │
             ▼
       ┌───────────┐
       │Hello World│
       ├───────────┤
       │Programming│
       └───────────┘
             │
             │ .collect(Collectors.toList())
             ▼
        ┌─────────┐
        │  СПИСОК │
        └─────────┘

Результат:
["Hello World", "Programming"]
```

### Пример: преобразование в верхний регистр

```
Исходные данные:        .map(String::toUpperCase)      Результат:
┌───────┐              ┌───────────┐                  ┌───────┐
│ hello │  ────────►   │ HELLO     │  ────────►       │ HELLO │
├───────┤              ├───────────┤                  ├───────┤
│ world │  ────────►   │ WORLD     │  ────────►       │ WORLD │
├───────┤              ├───────────┤                  ├───────┤
│ java  │  ────────►   │ JAVA      │  ────────►       │ JAVA  │
└───────┘              └───────────┘                  └───────┘

        .stream()      Преобразование      .collect(toList())
```

### Пример: группировка по длине

```
Исходные данные:
["Hi", "Java", "Code", "Hello", "World"]

        │
        │ .stream()
        ▼
    ┌───────┐
    │ ПОТОК │
    └───┬───┘
        │
        │ .collect(groupingBy(String::length))
        ▼
    ┌─────────────────────┐
    │   ГРУППИРОВКА       │
    │                     │
    │  Длина 2: ["Hi"]    │ ◄── Группа 1
    │  Длина 4: ["Java",  │ ◄── Группа 2
    │           "Code"]   │
    │  Длина 5: ["Hello", │ ◄── Группа 3
    │           "World"]  │
    └─────────────────────┘
        │
        ▼
    Map<Integer, List<String>>
```

---

## ⚙️ КАК РАБОТАЕТ ExecutorService

### Шаг 1: Создание пула потоков
```
Executors.newFixedThreadPool(4)
        │
        ▼
┌────────────────────────┐
│   ExecutorService      │
│  ┌──────┐ ┌──────┐    │
│  │Thread│ │Thread│    │
│  │  1   │ │  2   │    │
│  └──────┘ └──────┘    │
│  ┌──────┐ ┌──────┐    │
│  │Thread│ │Thread│    │
│  │  3   │ │  4   │    │
│  └──────┘ └──────┘    │
│                        │
│  ┌──────────────────┐ │
│  │  Очередь задач   │ │
│  │  [пусто]         │ │
│  └──────────────────┘ │
└────────────────────────┘
```

### Шаг 2: Добавление задач
```
executorService.submit(() -> { код задачи })
        │
        ▼
┌────────────────────────┐
│   ExecutorService      │
│  ┌──────┐ ┌──────┐    │
│  │Thread│ │Thread│    │
│  │  1   │ │  2   │    │
│  └──────┘ └──────┘    │
│  ┌──────┐ ┌──────┐    │
│  │Thread│ │Thread│    │
│  │  3   │ │  4   │    │
│  └──────┘ └──────┘    │
│                        │
│  ┌──────────────────┐ │
│  │  Очередь задач   │ │
│  │  [Task A]        │ │ ◄── Задачи ждут
│  │  [Task B]        │ │     своей очереди
│  │  [Task C]        │ │
│  └──────────────────┘ │
└────────────────────────┘
```

### Шаг 3: Выполнение задач
```
Потоки берут задачи из очереди
        │
        ▼
┌────────────────────────┐
│   ExecutorService      │
│  ┌──────┐ ┌──────┐    │
│  │Thread│ │Thread│    │
│  │  1   │ │  2   │    │
│  │[TaskA│ │[TaskB│    │ ◄── Выполняют
│  └──────┘ └──────┘    │     параллельно
│  ┌──────┐ ┌──────┐    │
│  │Thread│ │Thread│    │
│  │  3   │ │  4   │    │
│  │[TaskC│ │[ждёт]│    │
│  └──────┘ └──────┘    │
│                        │
│  ┌──────────────────┐ │
│  │  Очередь задач   │ │
│  │  [пусто]         │ │
│  └──────────────────┘ │
└────────────────────────┘
```

---

## 🎯 КАК РАБОТАЕТ Future

```
1. Отправляем задачу:
   Future<String> future = executor.submit(() -> {
       Thread.sleep(1000);  // долгая работа
       return "Результат";
   });
   
   Программа продолжает работать!
   
   ┌──────────────┐           ┌──────────────┐
   │ Главный поток│           │ Рабочий поток│
   │              │           │              │
   │ submit() ────┼──────────►│ выполняется  │
   │ ↓            │           │ задача...    │
   │ делаем что-то│           │ ...          │
   │ ещё...       │           │ ...          │
   │ ↓            │           │ готово!      │
   └──────────────┘           └──────────────┘

2. Когда нужен результат:
   String result = future.get();  // ЖДЁМ здесь!
   
   ┌──────────────┐           ┌──────────────┐
   │ Главный поток│           │ Рабочий поток│
   │              │           │              │
   │ future.get() │◄─────────┤ return       │
   │ БЛОКИРОВКА   │  результат│ "Результат"  │
   │ ...          │           │              │
   │ получили!    │           │              │
   └──────────────┘           └──────────────┘
```

---

## 📊 СРАВНЕНИЕ ПОДХОДОВ

### Старый подход (до Java 8):
```java
List<String> result = new ArrayList<>();
for (String s : data) {
    if (s.length() > 5) {
        result.add(s.toUpperCase());
    }
}
```
**Строк кода:** 5
**Читаемость:** ⭐⭐⭐
**Стиль:** Императивный ("КАК делать")

### Новый подход (Java 8+ Stream API):
```java
List<String> result = data.stream()
    .filter(s -> s.length() > 5)
    .map(String::toUpperCase)
    .collect(Collectors.toList());
```
**Строк кода:** 4
**Читаемость:** ⭐⭐⭐⭐⭐
**Стиль:** Декларативный ("ЧТО делать")

---

## 🔗 КАК ВСЁ СВЯЗАНО

```
                    ┌─────────────┐
                    │   Main()    │
                    └──────┬──────┘
                           │
                           ▼
                    ┌─────────────┐
                    │DataManager  │
                    │ создаётся   │
                    └──────┬──────┘
                           │
        ┌──────────────────┼──────────────────┐
        │                  │                  │
        ▼                  ▼                  ▼
┌──────────────┐  ┌──────────────┐  ┌──────────────┐
│    Filter    │  │  Transform   │  │  Aggregation │
│  Processor   │  │  Processor   │  │  Processor   │
└──────┬───────┘  └──────┬───────┘  └──────┬───────┘
       │                 │                 │
       │ Регистрация (registerDataProcessor)
       │                 │                 │
       └─────────────────┼─────────────────┘
                         │
                         ▼
                ┌─────────────────┐
                │ DataManager     │
                │ processors list │
                └────────┬────────┘
                         │
                         │ loadData()
                         ▼
                ┌─────────────────┐
                │   Input File    │
                └────────┬────────┘
                         │
                         ▼
                ┌─────────────────┐
                │ DataManager     │
                │ data list       │
                └────────┬────────┘
                         │
                         │ processData()
                         ▼
                ┌─────────────────┐
                │ ExecutorService │ ◄── Многопоточность
                │ (4 threads)     │
                └────────┬────────┘
                         │
           ┌─────────────┼─────────────┐
           │             │             │
           ▼             ▼             ▼
    ┌─────────┐   ┌─────────┐   ┌─────────┐
    │ Method 1│   │ Method 2│   │ Method 3│ ◄── Reflection
    │@DataProc│   │@DataProc│   │@DataProc│     находит методы
    └────┬────┘   └────┬────┘   └────┬────┘
         │             │             │
         │  Stream API обрабатывает  │
         │             │             │
         └─────────────┼─────────────┘
                       │
                       ▼
              ┌─────────────────┐
              │   Результаты    │
              │   объединяются  │
              └────────┬────────┘
                       │
                       │ saveData()
                       ▼
              ┌─────────────────┐
              │  Output File    │
              └─────────────────┘
```

---

## 💡 КЛЮЧЕВЫЕ МОМЕНТЫ

### 1. Аннотации = Метаданные
```
@DataProcessor
   ↓
Это не код, это информация О коде
   ↓
Reflection читает эту информацию
   ↓
И находит нужные методы
```

### 2. Stream = Конвейер
```
data → filter → map → collect → result
      ↑        ↑      ↑
      |        |      |
      Отбор  Измен. Сбор
```

### 3. Многопоточность = Параллелизм
```
1 поток:  [====][====][====] = 12 секунд
4 потока: [====]
          [====]              = 4 секунды
          [====]
          [====]
```

### 4. Future = Обещание
```
Сейчас: "Я обещаю дать результат" (Future)
Потом:  "Вот результат!"  (future.get())
```

---

## 🎓 ЗАКЛЮЧЕНИЕ

Этот проект демонстрирует:

✅ **Аннотации** — гибкая маркировка кода  
✅ **Reflection** — динамический анализ кода  
✅ **Stream API** — функциональная обработка данных  
✅ **Многопоточность** — параллельное выполнение  
✅ **Лямбды** — краткий и выразительный код  

Всё это вместе создаёт **мощную и элегантную** систему обработки данных!
